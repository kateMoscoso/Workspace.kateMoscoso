<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
<title>Untitled</title>
<script language="javascript">
function calcular(){
  tabla = document.getElementById("mitabla");
  // Buscamos TBody
  for (var i=0; i < tabla.childNodes.length; i++){
    if (tabla.childNodes[i].nodeType == 1){
      var tbody = tabla.childNodes[i];
      break;
    }
  }
  var contenidoTabla = new Array();
  // buscamos TR
  for (var i=0; i < tbody.childNodes.length; i++){
    if (tbody.childNodes[i].nodeType == 1){
      var tr = tbody.childNodes[i];.
      var indiceCelda = 0;
      contenidoTabla[contenidoTabla.length] = new Array();
      
      // Buscamos TH o TD
      for (var j=0; j < tr.childNodes.length; j++){
        if (tr.childNodes[j].nodeType == 1){
          var td = tr.childNodes[j];
          contenidoTabla[contenidoTabla.length-1][indiceCelda] = td.firstChild.nodeValue;
          indiceCelda++;
        }
      }
    }
  }
  //cadena1="";
  // media de los datos
  var divisor = contenidoTabla.length - 1;
  var media = Array(contenidoTabla[0].length);
  for (var i=1; i < contenidoTabla[0].length; i++)
    media[i] = 0;
  for (var i=1; i < contenidoTabla.length; i++){
    for (var j=1; j < contenidoTabla[i].length; j++){
      media[j] += parseInt(contenidoTabla[i][j])/divisor;
      //cadena1 += contenidoTabla[i][j]+" ";
    }
    //cadena1 += "\n";
  } 
  //alert(cadena1);
  //alert(media) 
  

var nuevaFila = document.createElement("tr");
nuevaFila.setAttribute("align","center");
// Primera celda
var primeraCelda = document.createElement("td");
var textoprimeraCelda = document.createTextNode("Total:");
primeraCelda.appendChild(textoprimeraCelda);
nuevaFila.appendChild(primeraCelda);
// Resto de celdas

for (var i=1; i < media.length; i++){
  var nuevaCelda = document.createElement("td");
  var textoNuevaCelda = document.createTextNode(media[i]);
  nuevaCelda.appendChild(textoNuevaCelda);
  nuevaFila.appendChild(nuevaCelda);
}

// añadir nuevaFila a Tbody de tabla
tbody.appendChild(nuevaFila);
  
}

</script>
</head>
<body>
<table id="mitabla" border=1 rules=cols>
  <tbody>
  <tr>
    <th>Nombre</th><th>Altura</th><th>Peso</th><th>Edad</th>
  </tr>
  <tr>
    <td>Lucía</td><td>166</td><td>56</td><td>33</td>
  </tr>
  <tr>
    <td>Michel</td><td>176</td><td>76</td><td>35</td>
  </tr>
  <tr>
    <td>Manuel</td><td>180</td><td>75</td><td>37</td>
  </tr>
 </tbody> 
</table>
<form>
  <button type="button" onclick="calcular()">Media</button>
</form>
</body>
</html>
